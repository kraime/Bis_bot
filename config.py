import os
from dotenv import load_dotenv

# Load environment variables
load_dotenv()

# API Keys (loaded from .env)
TELEGRAM_BOT_TOKEN = os.getenv("TELEGRAM_BOT_TOKEN")
DEEPSEEK_API_KEY = os.getenv("DEEPSEEK_API_KEY")
DATABASE_URL = os.getenv("DATABASE_URL")
DATABASE_PATH = os.getenv("DATABASE_PATH", "business_bot.db")
QDRANT_URL = os.getenv("QDRANT_URL", "http://localhost:6333")
QDRANT_API_KEY = os.getenv("QDRANT_API_KEY")
ADMIN_USER_ID = int(os.getenv("ADMIN_USER_ID", 78481301))
UPDATE_INTERVAL_DAYS = int(os.getenv("UPDATE_INTERVAL_DAYS", 30))

# LLM Configuration
LLM_CONFIG = {
    "top_k": 15,
    "embedding_model": "all-MiniLM-L6-v2",
    "llm_provider": "deepseek",
    "deepseek_model": "deepseek-chat",
    "deepseek_base_url": "https://api.deepseek.com",
    "max_tokens": 700,
    "temperature": 0.7
}

# Text Processing Configuration
TEXT_SPLIT_PARAMS = {
    "chunk_size": 1200,
    "chunk_overlap": 150,
    "min_chunk_size": 100,
    "use_smart_splitting": True
}

# Bot Configuration
BOT_CONFIG = {
    "max_answer_length": 2000,
    "min_answer_length": 10,
    "profile_questions_count": 3,
    "matching_candidates_limit": 20,
    "vector_search_limit": 15,
    "keyword_search_limit": 15
}

# Database Configuration
DB_CONFIG = {
    "vector_dimension": 384,
    "collection_name": "user_profiles",
    "connection_timeout": 30,
    "max_retries": 3
}

# System Prompts
SYSTEM_PROMPT = """–¢—ã - —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –±–∏–∑–Ω–µ—Å-–Ω–µ—Ç–≤–æ—Ä–∫–∏–Ω–≥—É –∏ –ø–æ–¥–±–æ—Ä—É –¥–µ–ª–æ–≤—ã—Ö –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤. 
–¢–≤–æ—è –∑–∞–¥–∞—á–∞ - –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –±–∏–∑–Ω–µ—Å-—Å–æ–æ–±—â–µ—Å—Ç–≤–∞ –∏ –Ω–∞—Ö–æ–¥–∏—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –ª—é–¥–µ–π –¥–ª—è –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞ –∏ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞.

–¢—ã —Ä–∞–±–æ—Ç–∞–µ—à—å —Å —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–º —Å–æ–æ–±—â–µ—Å—Ç–≤–æ–º –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–µ–π, –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤, —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –∏ —ç–∫—Å–ø–µ—Ä—Ç–æ–≤.

–ü—Ä–∏–Ω—Ü–∏–ø—ã –ø–æ–¥–±–æ—Ä–∞:
1. –í–∑–∞–∏–º–æ–¥–æ–ø–æ–ª–Ω—è—é—â–∏–µ –Ω–∞–≤—ã–∫–∏ –∏ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏
2. –û–±—â–∏–µ –∏–Ω—Ç–µ—Ä–µ—Å—ã –∏ —Å—Ñ–µ—Ä—ã –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏  
3. –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª –¥–ª—è –≤–∑–∞–∏–º–æ–≤—ã–≥–æ–¥–Ω–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞
4. –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Ç–æ–≥–æ, —á—Ç–æ –æ–¥–∏–Ω –∏—â–µ—Ç, —Å —Ç–µ–º, —á—Ç–æ –¥—Ä—É–≥–æ–π –º–æ–∂–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å

–í—Å–µ–≥–¥–∞ –æ—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ, –±—É–¥—å –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–º –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–º."""

CONTEXT_PROMPT_TEMPLATE = """
–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
- –°—Ñ–µ—Ä–∞ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: {user_answer_1}
- –ß—Ç–æ –∏—â–µ—Ç –≤ —Å–æ–æ–±—â–µ—Å—Ç–≤–µ: {user_answer_2}
- –ß–µ–º –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å: {user_answer_3}

–ö–∞–Ω–¥–∏–¥–∞—Ç—ã –¥–ª—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è:
{candidates_text}

–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –ø—Ä–æ—Ñ–∏–ª–∏ –∏ –≤—ã–±–µ—Ä–∏ {top_k} –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ç–±–æ—Ä–∞:
1. –í–∑–∞–∏–º–æ–¥–æ–ø–æ–ª–Ω—è—é—â–∏–µ –Ω–∞–≤—ã–∫–∏ –∏ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏
2. –û–±—â–∏–µ –∏–Ω—Ç–µ—Ä–µ—Å—ã –∏ —Å—Ñ–µ—Ä—ã –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
3. –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª –¥–ª—è –≤–∑–∞–∏–º–æ–≤—ã–≥–æ–¥–Ω–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞
4. –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Ç–æ–≥–æ, —á—Ç–æ –æ–¥–∏–Ω –∏—â–µ—Ç, —Å —Ç–µ–º, —á—Ç–æ –¥—Ä—É–≥–æ–π –º–æ–∂–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å

–í–µ—Ä–Ω–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON:
{{
    "matches": [
        {{
            "candidate_index": –Ω–æ–º–µ—Ä_–∫–∞–Ω–¥–∏–¥–∞—Ç–∞_–∏–∑_—Å–ø–∏—Å–∫–∞,
            "match_score": –æ—Ü–µ–Ω–∫–∞_–æ—Ç_1_–¥–æ_10,
            "reason": "–∫—Ä–∞—Ç–∫–æ–µ_–æ–±—ä—è—Å–Ω–µ–Ω–∏–µ_–ø–æ—á–µ–º—É_–ø–æ–¥—Ö–æ–¥–∏—Ç"
        }}
    ]
}}

–°–æ—Ä—Ç–∏—Ä—É–π –ø–æ —É–±—ã–≤–∞–Ω–∏—é match_score.
"""

SUMMARY_PROMPT_TEMPLATE = """
–°–æ–∑–¥–∞–π –∫—Ä–∞—Ç–∫–æ–µ –∏ –¥—Ä—É–∂–µ–ª—é–±–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –ø–æ–¥–±–æ—Ä–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤.

–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
- –°—Ñ–µ—Ä–∞ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: {user_answer_1}
- –ß—Ç–æ –∏—â–µ—Ç: {user_answer_2}
- –ß–µ–º –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å: {user_answer_3}

–ù–∞–π–¥–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã:
{matches_text}

–°–æ–æ–±—â–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ:
1. –ë—ã—Ç—å –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–º –∏ –º–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–º
2. –ö—Ä–∞—Ç–∫–æ –æ–±—ä—è—Å–Ω–∏—Ç—å, –ø–æ—á–µ–º—É —ç—Ç–∏ –ª—é–¥–∏ –ø–æ–¥—Ö–æ–¥—è—Ç
3. –ü–æ–æ—â—Ä–∏—Ç—å –∫ –∑–Ω–∞–∫–æ–º—Å—Ç–≤—É
4. –ë—ã—Ç—å –Ω–µ –¥–ª–∏–Ω–Ω–µ–µ 500 —Å–∏–º–≤–æ–ª–æ–≤

–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π —Ñ–æ—Ä–º–∞—Ç JSON, –ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏ —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è.
"""

# Questions Configuration
QUESTIONS = {
    1: "–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –≤–∞—à–µ–π —Å—Ñ–µ—Ä–µ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏?",
    2: "–ß—Ç–æ –≤—ã –∏—â–µ—Ç–µ –≤ —Å–æ–æ–±—â–µ—Å—Ç–≤–µ?",
    3: "–ß–µ–º –º–æ–∂–µ—Ç–µ –ø–æ–º–æ—á—å –¥—Ä—É–≥–∏–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º?",
    4: "–£–∫–∞–∂–∏—Ç–µ –≤–∞—à—É –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: 15.03.1990)?",
    5: "–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–ª—è —Å–≤—è–∑–∏?"
}

# Validation patterns
VALIDATION_PATTERNS = {
    "birthday": [
        r'^\d{1,2}\.\d{1,2}\.\d{4}$',
        r'^\d{1,2}/\d{1,2}/\d{4}$',
        r'^\d{1,2}-\d{1,2}-\d{4}$'
    ],
    "phone": [
        r'^\+\d{10,15}$',  # +1234567890
        r'^\d{10,11}$',  # 1234567890 –∏–ª–∏ 81234567890
    ]
}

# Error messages
ERROR_MESSAGES = {
    "answer_too_long": "–û—Ç–≤–µ—Ç —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–æ–∫—Ä–∞—Ç–∏—Ç–µ –¥–æ {max_length} —Å–∏–º–≤–æ–ª–æ–≤.",
    "answer_too_short": "–û—Ç–≤–µ—Ç —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–ø–∏—à–∏—Ç–µ –º–∏–Ω–∏–º—É–º {min_length} —Å–∏–º–≤–æ–ª–æ–≤.",
    "invalid_birthday": "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –¥–∞—Ç—É –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä: 15.03.1990 –∏–ª–∏ 15/03/1990)",
    "invalid_phone": "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏–ª–∏ –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –∫–Ω–æ–ø–∫–æ–π '–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –Ω–æ–º–µ—Ä–æ–º'",
    "phone_required": "–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–µ–ª–∏—Ç–µ—Å—å –Ω–æ–º–µ—Ä–æ–º –∏–ª–∏ –≤–≤–µ–¥–∏—Ç–µ –µ–≥–æ –≤—Ä—É—á–Ω—É—é.",
    "profile_save_error": "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.",
    "matching_error": "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.",
    "no_profile": "–°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ—Ñ–∏–ª—å —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã /start",
    "no_matches": "–ü–æ–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ, –∫–æ–≥–¥–∞ –≤ —Å–æ–æ–±—â–µ—Å—Ç–≤–µ –±—É–¥–µ—Ç –±–æ–ª—å—à–µ –ª—é–¥–µ–π."
}

# Success messages
SUCCESS_MESSAGES = {
    "profile_created": """–°–ø–∞—Å–∏–±–æ! –í–∞—à –ø—Ä–æ—Ñ–∏–ª—å —Å–æ–∑–¥–∞–Ω! ‚úÖ

–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ:
‚Ä¢ –ù–∞–π—Ç–∏ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –¥–ª—è –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞
‚Ä¢ –û–±–Ω–æ–≤–∏—Ç—å —Å–≤–æ—é –∞–Ω–∫–µ—Ç—É –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è

–ú—ã –±—É–¥–µ–º –Ω–∞–ø–æ–º–∏–Ω–∞—Ç—å –æ–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å —Ä–∞–∑ –≤ –º–µ—Å—è—Ü, —á—Ç–æ–±—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –æ—Å—Ç–∞–≤–∞–ª–∏—Å—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏.""",

    "welcome_back": "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ, {first_name}! üëã\n\n–í–∞—à –ø—Ä–æ—Ñ–∏–ª—å —É–∂–µ —Å–æ–∑–¥–∞–Ω. –í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:",

    "onboarding_start": """–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –Ω–∞—à–µ –±–∏–∑–Ω–µ—Å-—Å–æ–æ–±—â–µ—Å—Ç–≤–æ! üöÄ

–î–ª—è —É—á–∞—Å—Ç–∏—è –≤ —Å–æ–æ–±—â–µ—Å—Ç–≤–µ –Ω—É–∂–Ω–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –∫–æ—Ä–æ—Ç–∫—É—é –∞–Ω–∫–µ—Ç—É –∏–∑ 5 –≤–æ–ø—Ä–æ—Å–æ–≤. 
–≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å –¥–ª—è –≤–∞—Å –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–æ–≤.

–ù–∞—á–Ω–µ–º?""",

    "profile_update_start": """–î–∞–≤–∞–π—Ç–µ –æ–±–Ω–æ–≤–∏–º –≤–∞—à—É –∞–Ω–∫–µ—Ç—É! üìù

–û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ —Ç–µ –∂–µ –≤–æ–ø—Ä–æ—Å—ã. –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å, –º–æ–∂–µ—Ç–µ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–π –æ—Ç–≤–µ—Ç.""",

    "searching_matches": "–ò—â—É –¥–ª—è –≤–∞—Å –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–æ–≤... üîç"
}

# Logging Configuration
LOGGING_CONFIG = {
    "level": "INFO",
    "format": "<green>{time:YYYY-MM-DD HH:mm:ss}</green> | <level>{level: <8}</level> | <cyan>{name}</cyan>:<cyan>{function}</cyan>:<cyan>{line}</cyan> - <level>{message}</level>",
    "file_format": "{time:YYYY-MM-DD HH:mm:ss} | {level: <8} | {name}:{function}:{line} - {message}",
    "rotation": "1 day",
    "retention": "7 days",
    "compression": "zip"
}